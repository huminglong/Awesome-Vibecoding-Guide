# Cloudflare D1数据库

## 概述

Cloudflare D1是一个基于SQLite构建的无服务器SQL数据库，旨在Cloudflare的全球网络上运行。它专门针对Workers和Pages Functions进行了优化，提供快速、可扩展且极其高性价比的原生数据库解决方案。

## 主要好处

### 基于SQLite的强大功能
- **完整SQL支持** - 标准SQLite语法
- **ACID合规** - 可靠的事务
- **连接、索引、约束** - 所有标准SQL功能
- **JSON支持** - 存储和查询JSON数据
- **外键** - 维护数据完整性

### 边缘原生集成
- **零冷启动** - 始终就绪
- **原生Workers绑定** - 无连接字符串
- **全球复制** - 数据靠近用户（即将推出）
- **自动备份** - 时间点恢复
- **读取副本** - 全球扩展读取

### 极其便宜和可扩展
- **超级慷慨的免费层级**
- **线性定价** - 可预测的成本
- **无每数据库费用** - 按使用付费
- **自动扩展** - 无容量规划
- **卓越性能** - 边缘延迟

### 非常适合微SaaS
- **免费开始** - 零前期成本
- **随应用程序增长** - 平滑扩展
- **生产就绪** - 企业级可靠性
- **快速查询** - 亚10ms延迟
- **简单迁移** - 标准SQL

## 定价

### 免费层级（非常慷慨）
- **5 GB存储**每个账户
- **每天500万行读取**
- **每天10万行写入**
- **无限制数据库**
- 非常适合副业项目和微SaaS

### 付费计划（$5/月）
当您超过免费层级时：
- **每月250亿行读取**（之后每百万$0.001）
- **每月5000万行写入**（之后每百万$1.00）
- **包括5 GB存储**（之后每GB $0.75）

### 成本现实检验

**小型SaaS**（1,000个活跃用户）：
- 约500K读取/天 = 15M读取/月
- 约50K写入/天 = 1.5M写入/月
- 约1 GB存储
- **成本：$0**（在免费层级内！）

**增长的SaaS**（10,000个用户）：
- 约5M读取/天 = 150M读取/月
- 约500K写入/天 = 15M写入/月
- 约10 GB存储
- **成本：$5-10/月**

**比较**：
- **AWS RDS**：最低$50-200/月
- **PlanetScale**：$29+/月
- **Supabase**：$25+/月
- **D1**：相同工作负载$0-10/月

**D1比替代方案便宜5-20倍！**

## 入门

### 先决条件
- Cloudflare账户
- 安装Wrangler CLI（`npm install -g wrangler`）
- Worker或Pages项目

### 创建您的第一个数据库

```bash
# 创建新的D1数据库
wrangler d1 create my-database

# 输出显示：
[[d1_databases]]
binding = "DB"
database_name = "my-database"
database_id = "xxxx-xxxx-xxxx-xxxx"

# 将此复制到您的wrangler.toml
```

### 添加到wrangler.toml

```toml
name = "my-worker"
main = "src/index.ts"